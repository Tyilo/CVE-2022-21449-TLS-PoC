# CVE-2022-21449-TLS-PoC
CVE-2022-21449 ([also dubbed Psychic Signatures in the vulnerability writeup by Neil Madden](https://neilmadden.blog/2022/04/19/psychic-signatures-in-java/)) Proof of Concept demonstrating its usage with a vulnerable client and a malicious TLS server.

The malicious server presents a valid (as of 2022-04-20) cert chain for www.google.com which has an ECDSA pub key (secp256r1). However, the `crypto/ecdsa` package has been modified to present an invalid signature with `r = s = 0`. The vulnerable client accepts this invalid signature, allowing the rest of the TLS handshake to continue.

Aside from the removed `*_test.go` files while building & exploration, all the golang library changes made to get this PoC working are annotated with a comment. Search/grep for `CVE-2022-21449` in the `go/src` directory to find them.

# Building
Requires some existing golang installation as well as maven, then run `./build.sh`.

Tested on Ubuntu 20.04.4 LTS (WSL2) with OpenJDK 16.0.1 (build 16.0.1+9-Ubuntu-120.04, 2021-04-20)

# Testing
Run `./test.sh <docker-image-name>`.

For example:
```sh
# Vulnerable (as of 2022-04-21 12:00 UTC)
./test.sh openjdk:18
./test.sh openjdk:17
./test.sh eclipse-temurin:18
./test.sh eclipse-temurin:17
./test.sh azul/zulu-openjdk:17-jre

./test.sh amazoncorretto:18.0.0
./test.sh amazoncorretto:17.0.2

# Not vulnerable
./test.sh amazoncorretto:18
./test.sh amazoncorretto:17
./test.sh amazoncorretto:11

./test.sh openjdk:11
./test.sh eclipse-temurin:11
./test.sh azul/zulu-openjdk:11
```

# Demo
https://user-images.githubusercontent.com/7225227/164332612-832b046b-cd2e-46e8-b3d6-1da36e290992.mp4
